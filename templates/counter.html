<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Counter</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}"/>
</head>
<body>
    <div class="container">
        <img src="{{ url_for('static', filename='studybuns-logo.png') }}"/>
        <div class="focus-container">
            <h1>Focusing</h1>
            <div class="timer-container">
                <div class="circle">
                    <div class="mask full">
                        <div class="fill" id="fill"></div>
                    </div>
                    <div class="mask half">
                        <div class="fill"></div>
                    </div>
                    <div class="inner-circle">
                        <span id="timer"></span>
                    </div>
                </div>
            </div>
            <img class="image" src="{{ url_for('static', filename='studybunny.png') }}" alt="Bunny Congrats Image"/>
        </div>
    </div>

    <script>
        const counter = document.getElementById('timer');
        const fill = document.getElementById('fill');

        const focusTime = parseInt("{{ focus_time }}") * 60; 
        let timeLeft = focusTime;

        function countDown() {
            if (timeLeft <= 0) {
                window.location.href = '/congrats'; 
                return;
            }

            const minutes = Math.floor(timeLeft / 60);
            const seconds = timeLeft % 60;

            counter.textContent = 
                `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;

            const rotation = (1 - timeLeft / focusTime) * 360;
            fill.style.transform = `rotate(${rotation}deg)`; 

            timeLeft--;
        }

        setInterval(countDown, 1000);
        window.onload = countDown;
    </script>
</body>
</html>
